---
layout: default
title: Checkout - Roza Bridal
---

<div class="checkout-container">
  <div class="checkout-form">
    <h2>Checkout</h2>
    
    <!-- SIMPLIFIED CONTACT INFORMATION -->
    <div class="checkout-section">
      <h3>Contact Information</h3>
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
        <div class="form-group">
          <label for="checkout-first-name">First Name</label>
          <input type="text" id="checkout-first-name" required>
        </div>
        <div class="form-group">
          <label for="checkout-last-name">Last Name</label>
          <input type="text" id="checkout-last-name" required>
        </div>
      </div>
      <div class="form-group">
        <label for="checkout-email">Email</label>
        <input type="email" id="checkout-email" required>
      </div>
      <div class="form-group">
        <label for="checkout-phone">Phone</label>
        <input type="tel" id="checkout-phone" required>
      </div>
    </div>
    
    <!-- WEDDING DETAILS (OPTIONAL) -->
    <div class="checkout-section">
      <h3>Wedding Details (Optional)</h3>
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
        <div class="form-group">
          <label for="checkout-wedding-date">Wedding Date</label>
          <input type="date" id="checkout-wedding-date">
        </div>
        <div class="form-group">
          <label for="checkout-venue-style">Venue Style</label>
          <select id="checkout-venue-style">
            <option value="">Select venue style</option>
            <option value="garden">Garden/Outdoor</option>
            <option value="beach">Beach</option>
            <option value="church">Church</option>
            <option value="ballroom">Ballroom</option>
            <option value="rustic">Rustic/Barn</option>
            <option value="destination">Destination</option>
            <option value="city-hall">City Hall</option>
          </select>
        </div>
      </div>
    </div>
    
    <!-- PAYMENT OPTIONS SELECTION -->
    <div class="checkout-section">
      <h3>üí≥ Choose Your Payment Option</h3>
      
      <div class="payment-options-grid">
        <div class="payment-option-card" id="stripe-option">
          <div class="payment-option-header">
            <div class="payment-option-icon">‚ö°</div>
            <h4>Quick Stripe Checkout</h4>
          </div>
          <div class="payment-option-body">
            <p>Instant secure payment with credit card, debit card, or digital wallet</p>
            <ul class="payment-benefits">
              <li>‚úÖ Instant processing</li>
              <li>‚úÖ Bank-level security</li>
              <li>‚úÖ All major cards accepted</li>
              <li>‚úÖ Apple Pay & Google Pay</li>
            </ul>
          </div>
          <button class="select-payment-btn" data-payment="stripe">
            Select Stripe Checkout
          </button>
        </div>
        
        <div class="payment-option-card" id="custom-option">
          <div class="payment-option-header">
            <div class="payment-option-icon">‚ú®</div>
            <h4>Custom Consultation</h4>
          </div>
          <div class="payment-option-body">
            <p>Personalized service with payment link sent via email</p>
            <ul class="payment-benefits">
              <li>‚úÖ Personal consultation</li>
              <li>‚úÖ Custom payment terms</li>
              <li>‚úÖ Detailed order review</li>
              <li>‚úÖ 24-hour response</li>
            </ul>
          </div>
          <button class="select-payment-btn" data-payment="custom">
            Select Custom Service
          </button>
        </div>
      </div>
      
      <div id="selected-payment-info" class="selected-payment-info" style="display: none;">
        <div class="payment-selection-summary">
          <div class="selection-icon"></div>
          <div class="selection-text"></div>
        </div>
      </div>
    </div>
    
    <!-- ORDER NOTES -->
    <div class="checkout-section">
      <h3>Order Notes</h3>
      <div class="form-group">
        <label for="order-notes">Special Instructions (Optional)</label>
        <textarea id="order-notes" rows="4" placeholder="Any special instructions, timeline requirements, or customization notes..." style="width: 100%; padding: 1rem; border: 1px solid #e0e0e0; border-radius: 8px; font-family: inherit; font-size: 1rem; line-height: 1.5; resize: vertical;"></textarea>
        <p style="font-size: 0.85rem; color: #666; margin-top: 0.5rem; margin-bottom: 0;">
          üí° <strong>Tip:</strong> Include any custom measurements, color preferences, or special requests here
        </p>
      </div>
    </div>
  </div>
  
  <div class="checkout-summary">
    <h2>Order Summary</h2>
    
    <!-- Empty cart message -->
    <div class="empty-cart-notice" id="empty-cart-notice" style="text-align: center; padding: 3rem 1rem; color: #666; display: none;">
      <div style="font-size: 3rem; margin-bottom: 1rem;">üõçÔ∏è</div>
      <h3 style="margin-bottom: 1rem; color: #333;">Your cart is empty</h3>
      <p style="margin-bottom: 2rem;">Add some beautiful dresses to your cart before checkout.</p>
      <a href="{{ site.baseurl }}/products/" style="display: inline-block; padding: 1rem 2rem; background: #c9a96e; color: white; text-decoration: none; border-radius: 50px; font-weight: 600;">Browse Dresses</a>
    </div>
    
    <div class="checkout-items" id="checkout-items">
      <!-- Items will be populated by JavaScript -->
    </div>
    
    <div class="checkout-totals" id="checkout-totals">
      <div class="checkout-total-row">
        <span>Subtotal</span>
        <span id="checkout-subtotal">$0.00</span>
      </div>
      <div class="checkout-total-row">
        <span>Shipping</span>
        <span id="checkout-shipping" style="color: #28a745; font-weight: 600;">FREE SHIPPING</span>
      </div>
      <div class="checkout-total-row final">
        <span>Total</span>
        <span id="checkout-total">$0.00</span>
      </div>
    </div>
    
    <!-- COMPLETE ORDER BUTTON -->
    <button class="complete-order-button" id="complete-order-button" disabled>
      <div class="button-content">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="2" y="3" width="20" height="14" rx="2" ry="2"/>
          <line x1="8" y1="21" x2="16" y2="21"/>
          <line x1="12" y1="17" x2="12" y2="21"/>
        </svg>
        <span>Complete Order</span>
      </div>
    </button>
    
    <div class="checkout-security" style="text-align: center; margin-top: 1.5rem; padding: 1rem; background: #f8f9fa; border-radius: 8px;">
      <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">üîê</div>
      <p style="margin: 0; font-size: 0.9rem; color: #666;">
        Your information is secure and protected with bank-level encryption
      </p>
    </div>
  </div>
</div>

<style>
/* Payment Options Grid */
.payment-options-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;
  margin: 1.5rem 0;
}

.payment-option-card {
  border: 2px solid #e0e0e0;
  border-radius: 12px;
  padding: 0;
  background: white;
  transition: all 0.3s ease;
  overflow: hidden;
  position: relative;
}

.payment-option-card:hover {
  border-color: #c9a96e;
  transform: translateY(-2px);
  box-shadow: 0 8px 25px rgba(201, 169, 110, 0.15);
}

.payment-option-card.selected {
  border-color: #c9a96e;
  background: linear-gradient(135deg, #fefefe 0%, #f9f7f4 100%);
  transform: translateY(-2px);
  box-shadow: 0 8px 25px rgba(201, 169, 110, 0.2);
}

.payment-option-header {
  padding: 1.5rem 1.5rem 1rem;
  text-align: center;
}

.payment-option-icon {
  font-size: 2.5rem;
  margin-bottom: 1rem;
}

.payment-option-header h4 {
  margin: 0;
  font-family: 'Cormorant Garamond', serif;
  font-size: 1.3rem;
  color: #1a1a1a;
  font-weight: 400;
}

.payment-option-body {
  padding: 0 1.5rem 1rem;
  text-align: center;
}

.payment-option-body p {
  color: #666;
  margin-bottom: 1rem;
  font-size: 0.95rem;
  line-height: 1.5;
}

.payment-benefits {
  list-style: none;
  padding: 0;
  margin: 0 0 1.5rem 0;
}

.payment-benefits li {
  padding: 0.25rem 0;
  font-size: 0.85rem;
  color: #555;
  text-align: left;
}

.select-payment-btn {
  width: 100%;
  padding: 1rem;
  background: linear-gradient(135deg, #c9a96e 0%, #d4b875 100%);
  color: white;
  border: none;
  font-weight: 600;
  font-size: 0.9rem;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  cursor: pointer;
  transition: all 0.3s ease;
  margin: 0;
  border-radius: 0 0 10px 10px;
}

.select-payment-btn:hover {
  background: linear-gradient(135deg, #a08850 0%, #b89960 100%);
}

.payment-option-card.selected .select-payment-btn {
  background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
}

.selected-payment-info {
  margin-top: 1.5rem;
  padding: 1.5rem;
  background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%);
  border-radius: 12px;
  border-left: 4px solid #28a745;
}

.payment-selection-summary {
  display: flex;
  align-items: center;
  gap: 1rem;
}

.selection-icon {
  font-size: 1.5rem;
}

.selection-text {
  flex: 1;
}

.selection-text h5 {
  margin: 0 0 0.25rem 0;
  color: #155724;
  font-weight: 600;
}

.selection-text p {
  margin: 0;
  color: #155724;
  font-size: 0.9rem;
  opacity: 0.8;
}

/* Complete Order Button */
.complete-order-button {
  width: 100%;
  padding: 1.2rem;
  background: linear-gradient(135deg, #6772e5 0%, #5469d4 100%);
  color: white;
  border: none;
  border-radius: 8px;
  font-size: 1rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 20px rgba(103, 114, 229, 0.3);
  margin-bottom: 1rem;
  position: relative;
  overflow: hidden;
}

.button-content {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
}

.complete-order-button::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
  transition: left 0.5s;
}

.complete-order-button:hover::before {
  left: 100%;
}

.complete-order-button:hover:not(:disabled) {
  background: linear-gradient(135deg, #5469d4 0%, #4c63d2 100%);
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(103, 114, 229, 0.4);
}

.complete-order-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

/* Responsive Design */
@media (max-width: 768px) {
  .payment-options-grid {
    grid-template-columns: 1fr;
    gap: 1rem;
  }
  
  .checkout-container {
    grid-template-columns: 1fr;
    gap: 2rem;
  }
  
  .checkout-summary {
    position: static;
  }
  
  .payment-option-header {
    padding: 1rem 1rem 0.75rem;
  }
  
  .payment-option-icon {
    font-size: 2rem;
    margin-bottom: 0.75rem;
  }
  
  .payment-option-header h4 {
    font-size: 1.1rem;
  }
}
</style>

<script>
// Simplified checkout functionality with Stripe return handling
document.addEventListener('DOMContentLoaded', function() {
  // Check if user returned from Stripe and handle accordingly
  if (typeof handleStripeReturn === 'function') {
    handleStripeReturn();
  }
  
  loadCheckoutData();
  setupCheckoutForm();
  setupPaymentOptions();
  
  // Reset buttons if user came back from Stripe
  if (typeof resetCheckoutButtons === 'function') {
    resetCheckoutButtons();
  }
});

let selectedPaymentMethod = '';

function setupPaymentOptions() {
  const paymentButtons = document.querySelectorAll('.select-payment-btn');
  const selectedInfo = document.getElementById('selected-payment-info');
  const completeButton = document.getElementById('complete-order-button');
  
  paymentButtons.forEach(button => {
    button.addEventListener('click', function() {
      const paymentType = this.dataset.payment;
      
      // Clear previous selections
      document.querySelectorAll('.payment-option-card').forEach(card => {
        card.classList.remove('selected');
      });
      
      // Select current option
      this.closest('.payment-option-card').classList.add('selected');
      selectedPaymentMethod = paymentType;
      
      // Update UI
      updatePaymentSelection(paymentType);
      updateCompleteButton();
    });
  });
}

function updatePaymentSelection(paymentType) {
  const selectedInfo = document.getElementById('selected-payment-info');
  const selectionIcon = selectedInfo.querySelector('.selection-icon');
  const selectionText = selectedInfo.querySelector('.selection-text');
  
  if (paymentType === 'stripe') {
    selectionIcon.textContent = '‚ö°';
    selectionText.innerHTML = `
      <h5>Stripe Checkout Selected</h5>
      <p>You'll be redirected to secure Stripe payment after clicking Complete Order</p>
    `;
  } else if (paymentType === 'custom') {
    selectionIcon.textContent = '‚ú®';
    selectionText.innerHTML = `
      <h5>Custom Consultation Selected</h5>
      <p>We'll email you a secure payment link within 24 hours</p>
    `;
  }
  
  selectedInfo.style.display = 'block';
}

function updateCompleteButton() {
  const completeButton = document.getElementById('complete-order-button');
  const cartData = localStorage.getItem('rozaBridalCart');
  const cartItems = cartData ? JSON.parse(cartData) : [];
  
  // Enable if payment method selected and cart has items
  completeButton.disabled = !selectedPaymentMethod || cartItems.length === 0;
}

function loadCheckoutData() {
  const cartData = localStorage.getItem('rozaBridalCart');
  const cartItems = cartData ? JSON.parse(cartData) : [];
  
  const checkoutItems = document.getElementById('checkout-items');
  const emptyCartNotice = document.getElementById('empty-cart-notice');
  const checkoutTotals = document.getElementById('checkout-totals');
  const completeButton = document.getElementById('complete-order-button');
  
  if (cartItems.length === 0) {
    emptyCartNotice.style.display = 'block';
    checkoutItems.style.display = 'none';
    checkoutTotals.style.display = 'none';
    completeButton.style.display = 'none';
    return;
  }
  
  // Hide empty cart message
  emptyCartNotice.style.display = 'none';
  checkoutItems.style.display = 'block';
  checkoutTotals.style.display = 'block';
  completeButton.style.display = 'flex';
  
  // Auto-fill user data if logged in
  const userData = localStorage.getItem('rozaBridalUser');
  if (userData) {
    const user = JSON.parse(userData);
    document.getElementById('checkout-first-name').value = user.firstName || '';
    document.getElementById('checkout-last-name').value = user.lastName || '';
    document.getElementById('checkout-email').value = user.email || '';
    if (user.weddingDate) document.getElementById('checkout-wedding-date').value = user.weddingDate;
  }
  
  // Populate checkout items
  checkoutItems.innerHTML = cartItems.map((item, index) => {
    const customizationHtml = item.isCustom && item.customizations ? `
      <div class="checkout-item-customizations">
        <h5>‚ú® Custom Design Details:</h5>
        <p style="font-size: 0.85rem; line-height: 1.4;">
          <strong>Style:</strong> ${item.customizations.style}<br>
          <strong>Neckline:</strong> ${item.customizations.neckline}<br>
          <strong>Color:</strong> ${item.customizations.color}<br>
          <strong>Fabric:</strong> ${item.customizations.fabric}<br>
          <strong>Train:</strong> ${item.customizations.train}
          ${item.customizations.specialRequests ? `<br><strong>Special Requests:</strong> ${item.customizations.specialRequests}` : ''}
        </p>
      </div>
    ` : '';
    
    return `
      <div class="checkout-item">
        <img src="${item.image}" alt="${item.name}" class="checkout-item-image" onerror="this.src='{{ site.baseurl }}/assets/images/placeholder-dress.jpg'">
        <div class="checkout-item-details">
          <h4>${item.name}</h4>
          <p class="checkout-item-meta">Size: ${item.size} ‚Ä¢ Quantity: ${item.quantity}</p>
          <p class="checkout-item-price">$${(item.price * item.quantity).toFixed(2)}</p>
          ${customizationHtml}
        </div>
      </div>
    `;
  }).join('');
  
  // Calculate totals
  const subtotal = cartItems.reduce((total, item) => total + (item.price * item.quantity), 0);
  const total = subtotal;
  
  // Update totals
  document.getElementById('checkout-subtotal').textContent = `$${subtotal.toFixed(2)}`;
  document.getElementById('checkout-total').textContent = `$${total.toFixed(2)}`;
}

function setupCheckoutForm() {
  const completeButton = document.getElementById('complete-order-button');
  
  completeButton.addEventListener('click', function() {
    if (validateCheckoutForm()) {
      processOrder();
    }
  });
}

function validateCheckoutForm() {
  const requiredFields = [
    'checkout-first-name',
    'checkout-last-name',
    'checkout-email',
    'checkout-phone'
  ];
  
  let isValid = true;
  
  requiredFields.forEach(fieldId => {
    const field = document.getElementById(fieldId);
    if (!field.value.trim()) {
      field.style.borderColor = '#dc3545';
      isValid = false;
    } else {
      field.style.borderColor = '#c9a96e';
    }
  });
  
  if (!selectedPaymentMethod) {
    alert('Please select a payment method.');
    return false;
  }
  
  if (!isValid) {
    alert('Please fill in all required fields.');
    return false;
  }
  
  return true;
}

function processOrder() {
  const cartData = localStorage.getItem('rozaBridalCart');
  const cartItems = cartData ? JSON.parse(cartData) : [];
  
  if (cartItems.length === 0) {
    alert('Your cart is empty!');
    return;
  }
  
  // Get customer details
  const customerDetails = {
    firstName: document.getElementById('checkout-first-name').value,
    lastName: document.getElementById('checkout-last-name').value,
    email: document.getElementById('checkout-email').value,
    phone: document.getElementById('checkout-phone').value,
    weddingDate: document.getElementById('checkout-wedding-date').value,
    venueStyle: document.getElementById('checkout-venue-style').value,
    notes: document.getElementById('order-notes').value
  };
  
  // Show processing state
  const completeButton = document.getElementById('complete-order-button');
  const originalContent = completeButton.innerHTML;
  completeButton.innerHTML = '<div class="spinner"></div> Processing...';
  completeButton.disabled = true;
  
  // Handle based on payment method
  if (selectedPaymentMethod === 'stripe') {
    console.log('üîÑ Starting Stripe checkout process...');
    
    // DIRECT STRIPE CHECKOUT - Bypass function if needed
    if (cartItems.length === 1) {
      const item = cartItems[0];
      const cleanName = item.name.replace(/\s*\(Custom\)$/, '');
      
      // Manual product ID mapping for reliability
      const productIdMap = {
        'Boho Wedding Dress Elegant': 'boho-wedding-dress-elegant',
        'Boho Beach Wedding Dress': 'boho-beach-wedding-dress',
        'Custom Lace Mermaid Wedding Dress': 'custom-lace-mermaid-wedding-dress',
        'Custom Lace Mermaid Wedding Dress V-Neck': 'custom-lace-mermaid-wedding-dress-v-neck',
        'Elegant Ivory Satin Bridal Gown': 'elegant-ivory-satin-bridal-gown',
        'Floral Bridal Dress': 'floral-bridal-dress',
        'Gorgeous Ivory Mermaid Wedding Gown': 'gorgeous-ivory-mermaid-wedding-gown',
        'Minimalist Off Shoulder Satin Wedding Dress': 'minimalist-off-shoulder-satin-dress',
        'Modest Satin Wedding Dress': 'modest-satin-wedding-dress',
        'Sexy Fishtail Bridal Gown': 'sexy-fishtail-bridal-gown',
        'Sexy Sequin Mermaid Wedding Dress': 'sexy-sequin-mermaid-wedding-dress'
      };
      
      const stripeLinks = {
        'boho-wedding-dress-elegant': 'https://buy.stripe.com/4gM3cv3TA7sRc093EN1B600',
        'boho-beach-wedding-dress': 'https://buy.stripe.com/7sY6oHdua7sR6FP0sB1B601',
        'custom-lace-mermaid-wedding-dress': 'https://buy.stripe.com/5kQ00jcq614t4xH2AJ1B602',
        'custom-lace-mermaid-wedding-dress-v-neck': 'https://buy.stripe.com/00waEX2PweVj5BL6QZ1B603',
        'elegant-ivory-satin-bridal-gown': 'https://buy.stripe.com/3cI4gz2Pw8wV7JT6QZ1B604',
        'floral-bridal-dress': 'https://buy.stripe.com/cNi3cv9dUfZnggpcbj1B605',
        'gorgeous-ivory-mermaid-wedding-gown': 'https://buy.stripe.com/7sYaEX75MdRf0hrgrz1B606',
        'minimalist-off-shoulder-satin-dress': 'https://buy.stripe.com/28E9ATgGm9AZ7JTdfn1B607',
        'modest-satin-wedding-dress': 'https://buy.stripe.com/4gM3cvcq6cNbc09dfn1B608',
        'sexy-fishtail-bridal-gown': 'https://buy.stripe.com/eVqdR9bm2fZn4xHcbj1B609',
        'sexy-sequin-mermaid-wedding-dress': 'https://buy.stripe.com/7sY00jeye28xe8h7V31B60a'
      };
      
      const productId = productIdMap[cleanName];
      const stripeLink = stripeLinks[productId];
      
      console.log('üîç Direct Stripe lookup:', {
        itemName: item.name,
        cleanName: cleanName,
        productId: productId,
        stripeLink: stripeLink
      });
      
      if (stripeLink) {
        console.log('‚úÖ Stripe link found, redirecting...');
        
        // Save order context
        const orderContext = {
          item: item,
          customer: customerDetails,
          timestamp: Date.now(),
          orderId: 'RB-' + Date.now()
        };
        localStorage.setItem('stripeOrderContext', JSON.stringify(orderContext));
        
        // DON'T clear cart yet - save for potential return
        const checkoutBackup = {
          cart: cartItems,
          customer: customerDetails,
          timestamp: Date.now()
        };
        localStorage.setItem('checkoutBackup', JSON.stringify(checkoutBackup));
        
        // Redirect to Stripe
        setTimeout(() => {
          window.location.href = stripeLink;
        }, 500);
        
        return; // Stop here, don't continue to email fallback
      } else {
        console.log('‚ùå No Stripe link found for:', cleanName);
      }
    }
    
    // Reset button and fall back to email
    completeButton.innerHTML = originalContent;
    completeButton.disabled = false;
    alert('‚ö†Ô∏è Stripe checkout temporarily unavailable for this product.\n\nWe\'ll send you a secure payment link via email instead.');
    selectedPaymentMethod = 'custom';
  }
  
  // Custom/Email processing
  const orderData = createOrderData(cartItems, customerDetails);
  saveOrderToStorage(orderData);
  sendOrderEmail(orderData);
  
  // Reset button
  completeButton.innerHTML = originalContent;
  completeButton.disabled = false;
  
  // Show success message
  alert(`üéâ Order #${orderData.orderId} submitted!\n\nWe'll contact you within 24 hours with payment details and next steps.\n\nThank you for choosing Roza Bridal! ‚ú®`);
  
  // Clear cart and checkout state, then redirect
  localStorage.removeItem('rozaBridalCart');
  if (typeof clearCheckoutState === 'function') {
    clearCheckoutState();
  }
  window.location.href = '{{ site.baseurl }}/';
}

function createOrderData(cartItems, customerDetails) {
  return {
    orderId: 'RB-' + Date.now(),
    customer: customerDetails,
    items: cartItems,
    paymentMethod: selectedPaymentMethod,
    totals: {
      subtotal: cartItems.reduce((total, item) => total + (item.price * item.quantity), 0),
      shipping: 0,
      tax: 0,
      total: cartItems.reduce((total, item) => total + (item.price * item.quantity), 0)
    },
    orderDate: new Date().toISOString(),
    status: 'pending'
  };
}

function saveOrderToStorage(orderData) {
  const existingOrders = JSON.parse(localStorage.getItem('rozaBridalOrders') || '[]');
  existingOrders.push(orderData);
  localStorage.setItem('rozaBridalOrders', JSON.stringify(existingOrders));
}

function sendOrderEmail(orderData) {
  const itemsList = orderData.items.map(item => {
    const customDetails = item.isCustom && item.customizations ? `
CUSTOM DETAILS:
‚Ä¢ Style: ${item.customizations.style}
‚Ä¢ Neckline: ${item.customizations.neckline}
‚Ä¢ Color: ${item.customizations.color}
‚Ä¢ Fabric: ${item.customizations.fabric}
‚Ä¢ Train: ${item.customizations.train}
${item.customizations.specialRequests ? `‚Ä¢ Special Requests: ${item.customizations.specialRequests}` : ''}
` : '';
    
    return `
ITEM: ${item.name}
‚Ä¢ Size: ${item.size}
‚Ä¢ Quantity: ${item.quantity}
‚Ä¢ Price: ${item.price.toFixed(2)} each
‚Ä¢ Total: ${(item.price * item.quantity).toFixed(2)}
${customDetails}
`;
  }).join('\n');
  
  const subject = encodeURIComponent(`New Order #${orderData.orderId} - Roza Bridal`);
  const body = encodeURIComponent(`NEW ORDER RECEIVED - #${orderData.orderId}

üìß CUSTOMER DETAILS:
Name: ${orderData.customer.firstName} ${orderData.customer.lastName}
Email: ${orderData.customer.email}
Phone: ${orderData.customer.phone}

üíç WEDDING DETAILS:
Date: ${orderData.customer.weddingDate || 'Not specified'}
Venue Style: ${orderData.customer.venueStyle || 'Not specified'}

üí≥ PAYMENT METHOD: ${orderData.paymentMethod === 'stripe' ? 'Stripe Checkout' : 'Custom Consultation'}

üõçÔ∏è ORDER ITEMS:
${itemsList}

üí∞ ORDER TOTALS:
Subtotal: ${orderData.totals.subtotal.toFixed(2)}
Shipping: FREE SHIPPING ‚ú®
TOTAL: ${orderData.totals.total.toFixed(2)}

üìù ORDER NOTES:
${orderData.customer.notes || 'None'}

‚è∞ ORDER DATE: ${new Date(orderData.orderDate).toLocaleString()}

---
NEXT STEPS:
${orderData.paymentMethod === 'stripe' ? 
  '1. Process Stripe payment if not already completed\n2. Confirm order details with customer\n3. Begin production' :
  '1. Send secure payment link to customer\n2. Confirm customization details\n3. Begin production after payment'
}

Customer expects contact within 24 hours.`);
  
  window.open(`mailto:aetophis@aetophis.com?subject=${subject}&body=${body}`, '_blank');
}
</script>
