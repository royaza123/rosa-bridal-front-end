---
layout: default
title: Checkout - Roza Bridal
---

<div class="checkout-container">
  <div class="checkout-form">
    <h2>Checkout</h2>
    
    <div class="checkout-section">
      <h3>Contact Information</h3>
      <div class="form-group">
        <label for="checkout-email">Email</label>
        <input type="email" id="checkout-email" required>
      </div>
      <div class="form-group">
        <label for="checkout-phone">Phone</label>
        <input type="tel" id="checkout-phone" required>
      </div>
    </div>
    
    <div class="checkout-section">
      <h3>Shipping Address</h3>
      <div class="form-group">
        <label for="checkout-name">Full Name</label>
        <input type="text" id="checkout-name" required>
      </div>
      <div class="form-group">
        <label for="checkout-address">Address</label>
        <input type="text" id="checkout-address" required>
      </div>
      <div class="form-group">
        <label for="checkout-apartment">Apartment, suite, etc. (optional)</label>
        <input type="text" id="checkout-apartment">
      </div>
      <div class="form-row">
        <div>
          <label for="checkout-city">City</label>
          <input type="text" id="checkout-city" required>
        </div>
        <div>
          <label for="checkout-state">State/Province</label>
          <input type="text" id="checkout-state" required>
        </div>
        <div>
          <label for="checkout-postal">Postal Code</label>
          <input type="text" id="checkout-postal" required>
        </div>
      </div>
      <div class="form-group">
        <label for="checkout-country">Country</label>
        <select id="checkout-country" required>
          <option value="">Select Country</option>
          <option value="US">United States</option>
          <option value="CA">Canada</option>
          <option value="GB">United Kingdom</option>
          <option value="AU">Australia</option>
          <option value="DE">Germany</option>
          <option value="FR">France</option>
          <option value="IT">Italy</option>
          <option value="ES">Spain</option>
          <option value="NL">Netherlands</option>
          <option value="SE">Sweden</option>
          <option value="DK">Denmark</option>
          <option value="NO">Norway</option>
          <option value="PH">Philippines</option>
          <!-- Add more countries as needed -->
        </select>
      </div>
    </div>
    
    <div class="checkout-section">
      <h3>Payment Method</h3>
      
      <!-- STRIPE PAYMENT INTEGRATION -->
      <div class="payment-methods">
        <div class="payment-method stripe-payment active" id="stripe-payment-method">
          <div class="payment-method-header">
            <input type="radio" name="payment-method" id="stripe-radio" value="stripe" checked>
            <label for="stripe-radio">
              <div class="payment-method-info">
                <strong>üí≥ Secure Card Payment</strong>
                <p>Pay securely with credit card, debit card, or digital wallet</p>
              </div>
              <div class="stripe-badge">
                <svg width="40" height="17" viewBox="0 0 40 17" fill="none">
                  <path d="M39.4 6.8c0-.9-.7-1.5-1.6-1.5H36v3h1.8c.9 0 1.6-.6 1.6-1.5zM36 9.1v3h1.9c1 0 1.7-.6 1.7-1.5s-.7-1.5-1.7-1.5H36zM33.2 5.3h1.5v7.9h-1.5V5.3zM29.9 8.8c0-1.5 1-2.6 2.4-2.6s2.4 1.1 2.4 2.6-1 2.6-2.4 2.6-2.4-1.1-2.4-2.6zM28.4 8.8c0 2.4 1.8 4.1 3.9 4.1s3.9-1.7 3.9-4.1-1.8-4.1-3.9-4.1-3.9 1.7-3.9 4.1z" fill="#6772e5"/>
                  <path d="M18.4 5.8c-.5-.3-1.2-.5-2-.5-2.1 0-3.5 1.1-3.5 2.6 0 1.3 1 2.1 2.3 2.4l.6.1c.7.2 1.1.4 1.1.7 0 .5-.6.7-1.1.7-.7 0-1.2-.2-1.6-.4l-.2-.1-.2 1.3c.5.2 1.3.4 2.1.4 2.2 0 3.6-1.1 3.6-2.7 0-1.1-.6-1.9-2-2.3l-.6-.2c-.6-.2-.9-.3-.9-.6 0-.4.4-.6 1-.6.6 0 1 .1 1.3.3l.2.1.2-1.2c-.4-.2-1.1-.3-1.7-.3z" fill="#6772e5"/>
                  <path d="M25.8 4.7c-.4 0-.7.2-.9.6l-2.8 6.9h2.2l.4-1.1h2.6l.2 1.1h1.9l-1.7-7.5h-1.9zm-.4 5.1l1.1-2.9.6 2.9h-1.7z" fill="#6772e5"/>
                  <path d="M11.1 4.7l-1.8 7.5h2.1l1.8-7.5h-2.1zM8.5 4.7L6.7 9.8l-.8-4.2c-.1-.4-.3-.6-.6-.7H1.8L1.7 5c1.2.3 2.5.7 3.3 1.1l1.4 6.1h2.2l3.4-7.5H8.5z" fill="#6772e5"/>
                </svg>
              </div>
            </label>
          </div>
        </div>
        
        <div class="payment-method email-payment" id="email-payment-method">
          <div class="payment-method-header">
            <input type="radio" name="payment-method" id="email-radio" value="email">
            <label for="email-radio">
              <div class="payment-method-info">
                <strong>üìß Email Order Processing</strong>
                <p>We'll send you a secure payment link after reviewing your order</p>
              </div>
            </label>
          </div>
        </div>
      </div>
      
      <div class="form-group">
        <label for="order-notes">Order Notes (Optional)</label>
        <textarea id="order-notes" rows="3" placeholder="Any special instructions or timeline requirements..."></textarea>
      </div>
    </div>
  </div>
  
  <div class="checkout-summary">
    <h2>Order Summary</h2>
    
    <!-- Empty cart message -->
    <div class="empty-cart-notice" id="empty-cart-notice" style="text-align: center; padding: 3rem 1rem; color: #666; display: none;">
      <div style="font-size: 3rem; margin-bottom: 1rem;">üõçÔ∏è</div>
      <h3 style="margin-bottom: 1rem; color: #333;">Your cart is empty</h3>
      <p style="margin-bottom: 2rem;">Add some beautiful dresses to your cart before checkout.</p>
      <a href="{{ site.baseurl }}/products/" style="display: inline-block; padding: 1rem 2rem; background: #c9a96e; color: white; text-decoration: none; border-radius: 50px; font-weight: 600;">Browse Dresses</a>
    </div>
    
    <div class="checkout-items" id="checkout-items">
      <!-- Items will be populated by JavaScript -->
    </div>
    
    <div class="checkout-totals" id="checkout-totals">
      <div class="checkout-total-row">
        <span>Subtotal</span>
        <span id="checkout-subtotal">$0.00</span>
      </div>
      <div class="checkout-total-row">
        <span>Shipping</span>
        <span id="checkout-shipping" style="color: #28a745; font-weight: 600;">FREE SHIPPING</span>
      </div>
      <div class="checkout-total-row final">
        <span>Total</span>
        <span id="checkout-total">$0.00</span>
      </div>
    </div>
    
    <!-- STRIPE CHECKOUT BUTTON -->
    <button class="stripe-checkout-button" id="stripe-checkout-button" style="display: none;">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <rect x="2" y="3" width="20" height="14" rx="2" ry="2"/>
        <line x1="8" y1="21" x2="16" y2="21"/>
        <line x1="12" y1="17" x2="12" y2="21"/>
      </svg>
      Secure Checkout with Stripe
    </button>
    
    <!-- EMAIL ORDER BUTTON -->
    <button class="email-order-button" id="email-order-button" style="display: block;">
      üìß Send Order for Review
    </button>
    
    <div class="checkout-security" style="text-align: center; margin-top: 1.5rem; padding: 1rem; background: #f8f9fa; border-radius: 8px;">
      <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">üîí</div>
      <p style="margin: 0; font-size: 0.9rem; color: #666;">
        Your information is secure and protected. Choose your preferred payment method above.
      </p>
    </div>
  </div>
</div>

<!-- STRIPE PAYMENT LINKS CONFIGURATION -->
<script>
const STRIPE_PAYMENT_LINKS = {
  'boho-wedding-dress-elegant': 'https://buy.stripe.com/4gM3cv3TA7sRc093EN1B600',
  'boho-beach-wedding-dress': 'https://buy.stripe.com/7sY6oHdua7sR6FP0sB1B601',
  'custom-lace-mermaid-wedding-dress': 'https://buy.stripe.com/5kQ00jcq614t4xH2AJ1B602',
  'elegant-ivory-satin-bridal-gown': 'https://buy.stripe.com/3cI4gz2Pw8wV7JT6QZ1B604',
  'floral-bridal-dress': 'https://buy.stripe.com/cNi3cv9dUfZnggpcbj1B605',
  'gorgeous-ivory-mermaid-wedding-gown': 'https://buy.stripe.com/7sYaEX75MdRf0hrgrz1B606',
  'minimalist-off-shoulder-satin-dress': 'https://buy.stripe.com/28E9ATgGm9AZ7JTdfn1B607',
  'sexy-sequin-mermaid-wedding-dress': 'https://buy.stripe.com/7sY00jeye28xe8h7V31B60a',
  'sexy-fishtail-bridal-gown': 'https://buy.stripe.com/eVqdR9bm2fZn4xHcbj1B609',
  'modest-satin-wedding-dress': 'https://buy.stripe.com/4gM3cvcq6cNbc09dfn1B608'
};

// Enhanced checkout functionality with Stripe integration
document.addEventListener('DOMContentLoaded', function() {
  loadCheckoutData();
  setupCheckoutForm();
  setupPaymentMethods();
});

function setupPaymentMethods() {
  const stripeRadio = document.getElementById('stripe-radio');
  const emailRadio = document.getElementById('email-radio');
  const stripeButton = document.getElementById('stripe-checkout-button');
  const emailButton = document.getElementById('email-order-button');
  
  // Payment method toggle
  function togglePaymentMethod() {
    if (stripeRadio.checked) {
      stripeButton.style.display = 'block';
      emailButton.style.display = 'none';
    } else {
      stripeButton.style.display = 'none';
      emailButton.style.display = 'block';
    }
  }
  
  stripeRadio.addEventListener('change', togglePaymentMethod);
  emailRadio.addEventListener('change', togglePaymentMethod);
  
  // Stripe checkout handler
  stripeButton.addEventListener('click', function() {
    processStripeCheckout();
  });
  
  // Email order handler  
  emailButton.addEventListener('click', function() {
    processEmailOrder();
  });
  
  // Initial setup
  togglePaymentMethod();
}

function processStripeCheckout() {
  if (!validateCheckoutForm()) return;
  
  const cartData = localStorage.getItem('rozaBridalCart');
  const cartItems = cartData ? JSON.parse(cartData) : [];
  
  if (cartItems.length === 0) {
    alert('Your cart is empty!');
    return;
  }
  
  // For multiple items, we'll need to handle this differently
  // For now, let's use the first item's Stripe link or create a combined checkout
  if (cartItems.length === 1) {
    const item = cartItems[0];
    const productId = extractProductIdFromName(item.name);
    const stripeLink = STRIPE_PAYMENT_LINKS[productId];
    
    if (stripeLink) {
      // Track checkout
      if (typeof ml !== 'undefined') {
        ml('track', 'stripe_checkout_started', {
          product_id: productId,
          product_name: item.name,
          total_amount: calculateTotal()
        });
      }
      
      // Save order data for post-purchase processing
      saveOrderData('stripe');
      
      // Redirect to Stripe
      window.location.href = stripeLink;
    } else {
      alert('Stripe checkout not available for this item. Please use email processing.');
      document.getElementById('email-radio').checked = true;
      togglePaymentMethod();
    }
  } else {
    // Multiple items - fall back to email processing for now
    alert('For multiple items, please use email processing. We\'ll send you a secure payment link.');
    document.getElementById('email-radio').checked = true;
    setupPaymentMethods();
  }
}

function processEmailOrder() {
  if (!validateCheckoutForm()) return;
  
  const cartData = localStorage.getItem('rozaBridalCart');
  const cartItems = cartData ? JSON.parse(cartData) : [];
  
  if (cartItems.length === 0) {
    alert('Your cart is empty!');
    return;
  }
  
  // Save order and send email (existing functionality)
  const orderData = createOrderData();
  saveOrderToStorage(orderData);
  sendOrderEmail(orderData);
  
  // Show success and redirect
  alert(`üéâ Order #${orderData.orderId} submitted!\n\nWe'll review your order and send you a secure payment link within 24 hours.`);
  localStorage.removeItem('rozaBridalCart');
  window.location.href = `${document.querySelector('meta[name="base-url"]')?.content || ''}/`;
}

function extractProductIdFromName(productName) {
  const nameMap = {
    'Boho Wedding Dress Elegant': 'boho-wedding-dress-elegant',
    'Boho Beach Wedding Dress': 'boho-beach-wedding-dress',
    'Custom Lace Mermaid Wedding Dress': 'custom-lace-mermaid-wedding-dress',
    'Elegant Ivory Satin Bridal Gown': 'elegant-ivory-satin-bridal-gown',
    'Floral Bridal Dress': 'floral-bridal-dress',
    'Gorgeous Ivory Mermaid Wedding Gown': 'gorgeous-ivory-mermaid-wedding-gown',
    'Minimalist Off Shoulder Satin Wedding Dress': 'minimalist-off-shoulder-satin-dress',
    'Sexy Sequin Mermaid Wedding Dress': 'sexy-sequin-mermaid-wedding-dress',
    'Sexy Fishtail Bridal Gown': 'sexy-fishtail-bridal-gown',
    'Modest Satin Wedding Dress': 'modest-satin-wedding-dress'
  };
  
  return nameMap[productName] || null;
}

function saveOrderData(paymentMethod) {
  const orderData = createOrderData();
  orderData.paymentMethod = paymentMethod;
  orderData.stripeCheckout = paymentMethod === 'stripe';
  
  // Save to localStorage for post-purchase processing
  localStorage.setItem('pendingOrder', JSON.stringify(orderData));
  
  return orderData;
}

function calculateTotal() {
  const cartData = localStorage.getItem('rozaBridalCart');
  const cartItems = cartData ? JSON.parse(cartData) : [];
  return cartItems.reduce((total, item) => total + (item.price * item.quantity), 0);
}

// Keep existing functions for email processing
function createOrderData() {
  const cartData = localStorage.getItem('rozaBridalCart');
  const cartItems = cartData ? JSON.parse(cartData) : [];
  
  return {
    contact: {
      email: document.getElementById('checkout-email').value,
      phone: document.getElementById('checkout-phone').value
    },
    shipping: {
      name: document.getElementById('checkout-name').value,
      address: document.getElementById('checkout-address').value,
      apartment: document.getElementById('checkout-apartment').value,
      city: document.getElementById('checkout-city').value,
      state: document.getElementById('checkout-state').value,
      postal: document.getElementById('checkout-postal').value,
      country: document.getElementById('checkout-country').value
    },
    notes: document.getElementById('order-notes').value,
    items: cartItems,
    totals: {
      subtotal: calculateTotal(),
      shipping: 0,
      tax: 0,
      total: calculateTotal()
    },
    orderDate: new Date().toISOString(),
    orderId: 'RB-' + Date.now()
  };
}

function validateCheckoutForm() {
  const requiredFields = [
    'checkout-email',
    'checkout-phone', 
    'checkout-name',
    'checkout-address',
    'checkout-city',
    'checkout-state',
    'checkout-postal',
    'checkout-country'
  ];
  
  let isValid = true;
  
  requiredFields.forEach(fieldId => {
    const field = document.getElementById(fieldId);
    if (!field.value.trim()) {
      field.style.borderColor = '#dc3545';
      isValid = false;
    } else {
      field.style.borderColor = '#c9a96e';
    }
  });
  
  if (!isValid) {
    alert('Please fill in all required fields.');
    return false;
  }
  
  return true;
}

// Keep existing loadCheckoutData and other functions...
function loadCheckoutData() {
  // Get cart data from localStorage
  const cartData = localStorage.getItem('rozaBridalCart');
  const cartItems = cartData ? JSON.parse(cartData) : [];
  
  const checkoutItems = document.getElementById('checkout-items');
  const emptyCartNotice = document.getElementById('empty-cart-notice');
  const checkoutTotals = document.getElementById('checkout-totals');
  const stripeButton = document.getElementById('stripe-checkout-button');
  const emailButton = document.getElementById('email-order-button');
  
  if (cartItems.length === 0) {
    emptyCartNotice.style.display = 'block';
    checkoutItems.style.display = 'none';
    checkoutTotals.style.display = 'none';
    stripeButton.style.display = 'none';
    emailButton.style.display = 'none';
    return;
  }
  
  // Hide empty cart message
  emptyCartNotice.style.display = 'none';
  checkoutItems.style.display = 'block';
  checkoutTotals.style.display = 'block';
  
  // Populate checkout items
  checkoutItems.innerHTML = cartItems.map(item => {
    const customizationHtml = item.isCustom && item.customizations ? `
      <div class="checkout-item-customizations">
        <h5>‚ú® Custom Design Details:</h5>
        <p>
          <strong>Style:</strong> ${item.customizations.style}<br>
          <strong>Neckline:</strong> ${item.customizations.neckline}<br>
          <strong>Color:</strong> ${item.customizations.color}<br>
          <strong>Fabric:</strong> ${item.customizations.fabric}<br>
          <strong>Train:</strong> ${item.customizations.train}
          ${item.customizations.specialRequests ? `<br><strong>Special Requests:</strong> ${item.customizations.specialRequests}` : ''}
        </p>
      </div>
    ` : '';
    
    return `
      <div class="checkout-item">
        <img src="${item.image}" alt="${item.name}" class="checkout-item-image">
        <div class="checkout-item-details">
          <h4>${item.name}</h4>
          <p class="checkout-item-meta">Size: ${item.size} ‚Ä¢ Quantity: ${item.quantity}</p>
          <p class="checkout-item-price">$${(item.price * item.quantity).toFixed(2)}</p>
          ${customizationHtml}
        </div>
      </div>
    `;
  }).join('');
  
  // Calculate totals
  const subtotal = cartItems.reduce((total, item) => total + (item.price * item.quantity), 0);
  const total = subtotal;
  
  // Update totals
  document.getElementById('checkout-subtotal').textContent = `$${subtotal.toFixed(2)}`;
  document.getElementById('checkout-total').textContent = `$${total.toFixed(2)}`;
}

function setupCheckoutForm() {
  // Auto-fill user data if logged in
  const userData = localStorage.getItem('rozaBridalUser');
  if (userData) {
    const user = JSON.parse(userData);
    document.getElementById('checkout-email').value = user.email || '';
    document.getElementById('checkout-name').value = `${user.firstName} ${user.lastName}` || '';
  }
}
</script>

<style>
/* Payment Methods Styling */
.payment-methods {
  display: flex;
  flex-direction: column;
  gap: 1rem;
  margin-bottom: 2rem;
}

.payment-method {
  border: 2px solid #e0e0e0;
  border-radius: 8px;
  transition: all 0.3s ease;
  overflow: hidden;
}

.payment-method.active {
  border-color: #6772e5;
  box-shadow: 0 0 0 3px rgba(103, 114, 229, 0.1);
}

.payment-method-header {
  padding: 1.5rem;
  cursor: pointer;
}

.payment-method input[type="radio"] {
  margin-right: 1rem;
  transform: scale(1.2);
}

.payment-method label {
  display: flex;
  align-items: center;
  justify-content: space-between;
  cursor: pointer;
  margin: 0;
}

.payment-method-info h4 {
  margin: 0 0 0.25rem;
  font-size: 1.1rem;
  color: #333;
}

.payment-method-info p {
  margin: 0;
  font-size: 0.9rem;
  color: #666;
}

.stripe-badge {
  opacity: 0.8;
}

/* Payment Buttons */
.stripe-checkout-button,
.email-order-button {
  width: 100%;
  padding: 1.25rem;
  border: none;
  border-radius: 8px;
  font-size: 1.1rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  cursor: pointer;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  margin-bottom: 1rem;
}

.stripe-checkout-button {
  background: linear-gradient(135deg, #6772e5 0%, #5469d4 100%);
  color: white;
  box-shadow: 0 4px 20px rgba(103, 114, 229, 0.3);
}

.stripe-checkout-button:hover {
  background: linear-gradient(135deg, #5469d4 0%, #4c63d2 100%);
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(103, 114, 229, 0.4);
}

.email-order-button {
  background: linear-gradient(135deg, #c9a96e 0%, #d4b875 100%);
  color: white;
  box-shadow: 0 4px 20px rgba(201, 169, 110, 0.3);
}

.email-order-button:hover {
  background: linear-gradient(135deg, #a08850 0%, #b89960 100%);
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(201, 169, 110, 0.4);
}

@media (max-width: 768px) {
  .payment-method-header {
    padding: 1rem;
  }
  
  .payment-method label {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.5rem;
  }
  
  .stripe-badge {
    align-self: flex-end;
  }
}
</style>
